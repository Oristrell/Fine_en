<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PSI Calculator</title>

<style>
body {
  background-color: #87CEEB; /* sky blue page background */
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 40px 0;
}

.container {
  background-color: #fffde7; /* light yellow */
  width: 850px;              
  max-width: 95%;            
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.15);
  margin: 0 auto;
  text-align: left;
}

.title {
  display: flex;             /* use flex to place logo and text side by side */
  align-items: center;       /* vertically center the text with the logo */
  gap: 15px;                 /* space between logo and text */
  text-align: left;          /* text starts from left */
  color: #3366cc;            /* medium blue text */
  margin-bottom: 30px;
  border: 2px solid #3366cc; /* same color as text */
  border-radius: 8px;
  background-color: #e6f0ff; /* light blue box */
  padding: 15px 20px;
  font-size: 24px;
  font-weight: bold;
}

.logo {
  max-width: 60px;           /* adjust size as needed */
  height: auto;
}

.inner {
  max-width: 700px;
  margin: 0 auto;
  padding-left: 200px;         /* shift questions to the right */
  padding-right: 20px;
}

.section {
  margin-bottom: 20px;
}

.result {
  font-size: 20px;
  font-weight: bold;
  margin-top: 20px;
}

.badge {
  padding: 10px 15px;
  border-radius: 8px;
  display: inline-block;
  margin-top: 10px;
  font-weight: bold;
}

.classI { background-color: #4CAF50; color: white; }
.classII { background-color: #8BC34A; color: white; }
.classIII { background-color: #FFC107; color: black; }
.classIV { background-color: #FF9800; color: white; }
.classV { background-color: #F44336; color: white; }

button {
  padding: 10px 20px;
  font-size: 16px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  margin-top: 10px;
  margin-right: 10px;
}

button:hover {
  opacity: 0.85;
}

.reference {
  font-size: 12px;
  margin-top: 40px;
  color: #555;
}
</style>
</head>

<body>

<div class="container">
  <h2 class="title">
    <img src="LogOM5.png" alt=""Logo" class="logo">
    Pneumonia Severity Index (PSI), according to Fine et al
  </h2>

  <div class="inner">
    <div class="section">
      <label>Age:</label>
      <input type="number" id="age">
    </div>
  <div id="warning" style="color: red; font-weight: bold; margin-bottom: 10px;"></div>  

    <div class="section">
      <label>Sex:</label>
      <select id="sex">
        <option value="0">Man</option>
        <option value="-10">Woman</option>
      </select>
    </div>

    <div class="section">
      <label>
        <input type="checkbox" id="nursing">
        Living in nursing home(+10)
      </label>
    </div>

    <div class="section">
      <strong>Comorbidities</strong><br>
      <label><input type="checkbox" value="30" class="comorb"> Active neoplasia (excludes non-melanoma skin cancer)(+30)</label><br>
      <label><input type="checkbox" value="20" class="comorb"> Liver cirrhosis or chronic active hepatitis (+20)</label><br>
      <label><input type="checkbox" value="10" class="comorb"> Heart failure (systolic or dyastolic) (+10)</label><br>
      <label><input type="checkbox" value="10" class="comorb"> Past stroke or TIA (+10)</label><br>
      <label><input type="checkbox" value="10" class="comorb"> Acute or chronic Renal failure (+10)</label><br>
    </div>

    <div class="section">
      <strong>Physical exam</strong><br>
      <label><input type="checkbox" value="20" class="phys"> Altered mental status (+20)</label><br>
      <label><input type="checkbox" value="20" class="phys"> Respiratory frequency > 30 rpm (+20)</label><br>
      <label><input type="checkbox" value="20" class="phys"> Systolic blood pressure < 90mmHg (+20)</label><br>
      <label><input type="checkbox" value="15" class="phys"> Temperature < 35ºC o ≥ 40ºC (+15)</label><br>
      <label><input type="checkbox" value="10" class="phys"> Heart frequency ≥ 125 bpm (+10)</label><br>
    </div>

    <div class="section">
      <strong>Lab and Image</strong><br>
      <label><input type="checkbox" value="30" class="lab"> Arterial pH < 7.35 (+30)</label><br>
      <label><input type="checkbox" value="20" class="lab"> BUN ≥ 30 mg/dL (or serum Urea ≥ 64mg/dl) (+20)</label><br>
      <label><input type="checkbox" value="20" class="lab"> Na < 130 mEq/L (+20)</label><br>
      <label><input type="checkbox" value="10" class="lab"> Serum glucose ≥ 250 mg/dL (+10)</label><br>
      <label><input type="checkbox" value="10" class="lab"> Hematocrit < 30% (+10)</label><br>
      <label><input type="checkbox" value="10" class="lab"> pO2 < 60 mmHg (or Sat O2 <90%) (+10)</label><br>
      <label><input type="checkbox" value="10" class="lab"> Pleural fluid (+10)</label><br>
    </div>

    <button onclick="calculate()">Calculate Score</button>
    <button onclick="resetForm()">Reset</button>

    <div class="result" id="result"></div>
    <div id="fineClass"></div>

    <div class="reference">
      Basat en: Fine MJ, Auble TE, Yealy DM et al.
      <em>A Prediction Rule to Identify Low-Risk Patients with Community-Acquired Pneumonia.</em>
      N Engl J Med 1997; 336(4):243–250.
    </div>
  </div>
</div>

<script>
function calculate() {
  let warningDiv = document.getElementById("warning");
  let ageInput = document.getElementById("age");

  // Clear previous warning
  warningDiv.innerHTML = "";

  if (ageInput.value === "") {
    warningDiv.innerHTML = "Please, type the age of the patient.";
    ageInput.focus();
    return;  // stop calculation
  }

  let age = parseInt(ageInput.value);
  let sexAdjustment = parseInt(document.getElementById("sex").value) || 0;
  let nursing = document.getElementById("nursing").checked ? 10 : 0;

  let score = age + sexAdjustment + nursing;

  function addCheckboxValues(className) {
    let boxes = document.querySelectorAll("." + className + ":checked");
    boxes.forEach(box => score += parseInt(box.value));
    return boxes.length;
  }

  let comorbCount = addCheckboxValues("comorb");
  let physCount = addCheckboxValues("phys");
  addCheckboxValues("lab");

  document.getElementById("result").innerHTML = "PSI Score: " + score;

  let fineClass = "";
  let classStyle = "";

  if (age <= 50 && comorbCount === 0 && physCount === 0) {
    fineClass = "Fine Class I (Very Poor Risk)";
    classStyle = "classI";
  } else if (score <= 70) {
    fineClass = "Fine Class II";
    classStyle = "classII";
  } else if (score <= 90) {
    fineClass = "Fine Class III";
    classStyle = "classIII";
  } else if (score <= 130) {
    fineClass = "Fine Class IV";
    classStyle = "classIV";
  } else {
    fineClass = "Fine Class V";
    classStyle = "classV";
  }

  document.getElementById("fineClass").innerHTML =
    "<div class='badge " + classStyle + "'>" + fineClass + "</div>";
}

function resetForm() {
  document.getElementById("age").value = "";
  document.getElementById("sex").selectedIndex = 0;
  document.getElementById("nursing").checked = false;

  document.querySelectorAll("input[type='checkbox']").forEach(box => box.checked = false);

  document.getElementById("result").innerHTML = "";
  document.getElementById("fineClass").innerHTML = "";
}
</script>

</body>
</html>



